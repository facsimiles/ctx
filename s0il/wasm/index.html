<html>
        <head>
        <title>s0il - a 32bit program environment with vector graphics</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <script src="./s0il.js"></script>
        <script>
                function windowToCanvas(canvas, x, y) {
   var bbox = canvas.getBoundingClientRect();

   return { x: (x - bbox.left) * (canvas.width  / bbox.width),
            y: (y - bbox.top)  * (canvas.height / bbox.height)
          };
}
        </script>
        <style>
                canvas {image-rendering: sharp; image-rendering: -webkit-optimize-contrast;  image-rendering: -moz-crisp-edges;}
              body {font-size: calc(1.0vh + 1.8vw); margin:0 0 0 0;}
             input {font-size: calc(0.8vh + 1.1vw); }
              @media (orientation:portrait) {
                canvas {width: 100%;}
              } 
              @media (orientation:landscape) {
                canvas {height: 100%;float:left;margin-right:0.5em;}
              } 
              p, pre { padding-left: 0.5em; padding-right: 0.5em;}
        </style>
        </head>
        <body><canvas id='c' width='240' height='240' tabindex='0'></canvas>

<h3>s0il</h3>
<p>s0il is a small program environment for programs for 32bit systems and beyond.

</p><p>

s0il contains a partial libc implementation/wrapper for IO with access to a
RAM file system, and a program loader capable of running other <tt>main_foo(int
argc, char **argv);</tt> functions bundled in the binary, and xtensa/x86_64
loading shared ELF binaries. Programs can also be interpreted by starting with
<tt>#!</tt> or <tt>//!</tt>. By using only interpreted or bundled programs,
systems can be built that run the same across all targets.

</p><p>

<b><tt>system</tt></b>: pipes are implemented like in DOS, using temporary
files. By default programs are also sharing the stack of the invoker.
Backgrounding with <tt>&amp;</tt> is only supported when the underlying
platform has pthreads (posix/freertos).

</p><p>

<b><tt>stdin,stdout,stderr</tt></b> gets/fgets provides in-band text editor, stdin,stdout and stderr are treated as constants, internally each running program might have different streams hooked up - or be virtually duplicated 

</p><p>

<b><tt>fopen,opendir,fread,ftell,fwrite,fprint,unlink,rename,mkdir,..</tt></b>
s0il contains a RAM filesystem - with file contents intitially backed
by read-only data contained in the s0il binary. The locations used
with this is /tmp /bin, / and /data, files added or modified here are
stored in heap memory. Files in /tmp are used for to implement piping
and thus piping large amounts of data will OOM. The RAM filesystem can be used
also baremetal without a filesystem in the libc.

</p><p>
In the wasm simulator on this page /sd is a persistent filesystem
stored in indexdb on your browser. The filesystem is synced on
shutdown (exit from main menu) or if sync() is invoked.
</p><p>

<b><tt>getpid,getppid,exit,getcwd</tt></b>makes use of
per program data instead of sharing the global state.
</p><p>

The picoc interpreter comes with quite full bindings for the ctx
and s0il APIs, adding bindings for lua, quickjs and a micropython
interpreter are not done yet.
</p><p>

The UI layer is similar to a small browser shell, it has a location
the can be set, and a history to get back to previous states, sniffing
of the first 512 bytes is done to determine mime types, new mime types
can be registered, also folders can be registered with their own handlers
by specifying a file which if present makes the folder not report
mime-type of inode/directory.

</p><p>
   
I you have a flow3r, you might want to run it there, here is a pre-built binary: <a href='s0il-flow3r.bin'>flow3r firmware</a>
           
<h2>Building s0il</h2>
<p>This might work:</p>
<pre>
git clone https://ctx.graphics/.git/
cd git.graphics
make
make
cd s0il
make test
make help</pre>

</body></html>
