app-id: graphics.ctx.terminal
runtime: org.freedesktop.Platform
runtime-version: '20.08'
sdk: org.freedesktop.Sdk
finish-args:
  - --socket=pulseaudio
  - --socket=ssh-auth
  - --socket=fallback-x11
  - --device=dri
  - --talk-name=org.freedesktop.Flatpak

command: ctx
modules:
        - name: babl
          buildsystem: meson
          config-opts:
            - -Dlibdir=lib
          sources:
           - type: git
             url: https://gitlab.gnome.org/GNOME/babl.git
             branch: BABL_0_1_86
        - name: ctx
          buildsystem: simple
          build-commands:
                - ./configure.sh
                - make
                - strip ctx
                - install -D ctx /app/bin/ctx
                - install -D -m644 -t /app/share/appdata meta/graphics.ctx.terminal.appdata.xml
                - install -D -m644 -t /app/share/applications meta/graphics.ctx.terminal.desktop
                - install -D -m644 -t /app/share/icons/hicolor/64x64/apps meta/graphics.ctx.terminal.png
          sources:
           - type: git
             url: file:///home/pippin/src/ctx/.git
             disable-shallow-clone: true
             branch: dev
